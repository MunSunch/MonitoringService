# Monitoring-Service. Домашнее задание Servlet API и AOP

## Требования:

- Все взаимодействие должно теперь осуществляться через отправку HTTP запросов

- Сервлеты должны принимать JSON и отдавать также JSON

- Для сериализации и десереализации использовать jackson

- Использовать понятное именование эндпоинтов

- Возвращать разные статус-коды

- Добавить  DTO (если ранее не было заложено в логике)

- Для маппинга сущностей в дто использовать MapStruct

- Реализовать валидацию входящих ДТО

- Аудит переделать на аспекты через аннотацию

- Также реализовать на аспектах логирование выполнения любого метода (с замером времени выполнения)

- Сервлеты должны быть покрыты тестами

## Особенности реализации 
Создан новый модуль Server, в котором содержится встроенная реализация Apache Tomcat. Для взаимодействия
по сети создан DispatcherServlet, который передает обработку запроса контроллерам в модуле ServiceBackend.
Для организации безопасности в модуле Server создан DelegateFilter, который передает свои обязанности
SecurityFilter с определенной логикой обработки эндпоинтов, а именно подобие JWT аутентификации(торопился, прошу простить за реализацию).
Так, при первой аутентификации по эндпоинту <POST /login> сервер выдает DTO с токеном, который должен 
подставляться в заголовок запроса, название которого определено в app.properties.
Api можно найти по [ссылке](https://www.postman.com/navigation-candidate-51855014/workspace/system-projects/collection/27612511-b3e10f74-8d03-4f00-9c28-805ee707e3b1?action=share&creator=27612511)


В модуле Logger реализован аспекты с логированием скорости выполнения метода в миллисекундах.

В модуле Commons/utils создан класс Validator для валидации входящих DTO. Реализация основана на чтении
и обработке аннотаций.

Учтены прошлые ошибки:

- в модуле Commons/utils создан PropertyService для скрытия логики работы со свойствами;
- выброшенные исключения пробрасывается выше по стеку с возвратом ошибки internal_server и сообщением,
и обертываются в исключения-обертки для отладки;

По умолчанию предопределены два пользователя USER(login=user,password=user) и ADMIN(login=admin,password=admin) для облегчения тестирования. Что может пользователь с ролью USER:

1. получение актуальных показаний счетчиков
2. подача показаний
3. просмотр показаний за конкретный месяц
4. просмотра истории подачи показаний

Что может пользователь с ролью ADMIN:

1. получение актуальных показаний счетчиков всех пользователей
2. просмотра истории подачи показаний всех пользователей
3. просмотр показаний за конкретный месяц всех пользователей
4. просмотр действий пользователей
5. добавить новый тип показания

## Сборка и запуск проекта
Убедиться, что Docker-daemon присутствует в системе. Перейти в корень и собрать проект:

```
mvn clean install
```

или запуск без прогона интеграционных тестов

```
mvn clean package -DskipTests=true
```
Запустить Postgres:

```
docker compose up -d
```

Запустить сборку:

```
java -jar MonitoringServiceApp/target/MonitoringService.jar
```